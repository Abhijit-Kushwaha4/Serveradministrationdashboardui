import{b as v,r,j as e}from"./index-DSQQ7QIl.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]],N=v("bug",k),S=({url:l,noScript:u,userAgent:a,onPageLoad:g,onFetchError:p,isDebugMode:b,localTestContent:o})=>{const[y,n]=r.useState(!0),[h,x]=r.useState(null),[d,m]=r.useState(""),f=r.useRef(null);return r.useEffect(()=>{if(!l&&!o)return;if(n(!0),x(null),m(""),o){const s=f.current.contentWindow.document;s.open(),s.write(o),s.close(),n(!1);return}(async()=>{try{const s=await fetch(`/api/browse?url=${encodeURIComponent(l)}&noScript=${u}&userAgent=${a}`),t=await s.json();if(!s.ok)throw new Error(`Proxy Error (${s.status}): ${t.message||"No Data Received."}`);g(t),m(t.html);const c=f.current.contentWindow.document;c.open(),c.write(t.html),c.close()}catch(s){console.error("[DIAGNOSTIC_ERROR]",s),x(s),m(`{ "error": "${s.message}" }`),p(s)}finally{n(!1)}})()},[l,u,a,g,p,o]),b?e.jsxs("div",{className:"w-full h-full p-2 bg-black text-green-400 font-mono text-xs",children:[e.jsx("h2",{className:"text-lg text-yellow-400 mb-2",children:"DEBUG MODE: Raw Proxy Output"}),e.jsx("textarea",{readOnly:!0,className:"w-full h-full bg-gray-900 border border-green-700 p-2",value:d})]}):e.jsxs("div",{className:"w-full h-full relative bg-black overflow-y-auto",children:[y&&e.jsx("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-cyber-dark-surface",children:e.jsx("p",{className:"text-white animate-pulse",children:"Loading Content..."})}),h&&e.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center p-4 text-center",children:e.jsxs("div",{className:"bg-red-900/80 border border-red-500 text-white p-8 rounded-lg backdrop-blur-sm",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"FETCH FAILED"}),e.jsx("p",{className:"text-red-300",children:h.message})]})}),e.jsx("iframe",{ref:f,title:l||"local-test",className:`w-full h-full border-none transition-opacity duration-300 ${y||h?"opacity-0":"opacity-100"}`,sandbox:"allow-scripts allow-same-origin allow-popups allow-forms"})]})},M=()=>{const[l,u]=r.useState([{id:1,url:"https://google.com",title:"Google",history:["https://google.com"],historyIndex:0}]),[a,g]=r.useState(1),[p,b]=r.useState("https://google.com"),[o,y]=r.useState({noScript:!1,userAgent:"desktop"}),[n,h]=r.useState(!1),[x,d]=r.useState("");l.find(t=>t.id===a);const m=r.useCallback(t=>{d(""),u(c=>c.map(i=>i.id===a?{...i,title:t.title}:i))},[a]),f=r.useCallback(()=>{d("")},[]),j=(t,c=a)=>{const i=t.includes("://")?t:`https://duckduckgo.com/?q=${encodeURIComponent(t)}`;u(l.map(w=>w.id===c?{...w,url:i,title:"Loading..."}:w)),b(i),d("")},s=t=>{t.preventDefault(),j(p)};return e.jsxs("div",{className:"w-full h-full bg-cyber-dark-surface flex flex-col text-white font-sans",children:[e.jsxs("div",{className:"bg-cyber-surface p-2 flex items-center gap-2 border-b border-cyber-border z-20",children:[e.jsx("form",{onSubmit:s,className:"flex-1",children:e.jsx("input",{type:"text",value:p,onChange:t=>b(t.target.value),className:"w-full bg-cyber-glass px-4 py-2 rounded-md border border-cyber-border",placeholder:"Enter URL or search..."})}),e.jsx("button",{onClick:()=>h(!n),className:`p-2 rounded-md ${n?"bg-yellow-500 text-black":"hover:bg-cyber-glass"}`,title:"Debug Mode",children:e.jsx(N,{size:16})}),e.jsx("button",{onClick:()=>d("<h1>IT WORKS</h1><p>The iframe element is capable of rendering.</p>"),className:"p-2 rounded-md hover:bg-cyber-glass",title:"Test Local Render",children:"Test Render"})]}),e.jsx("div",{className:"flex-1 relative flex min-h-0",children:e.jsx("div",{className:"flex-1 relative",children:l.map(t=>e.jsx("div",{className:`w-full h-full absolute top-0 left-0 ${a===t.id?"z-10":"z-0"}`,children:a===t.id&&e.jsx(S,{url:t.url,noScript:o.noScript,userAgent:o.userAgent,onPageLoad:m,onFetchError:f,isDebugMode:n,localTestContent:x})},t.id))})})]})};export{M as BrowserApp};
