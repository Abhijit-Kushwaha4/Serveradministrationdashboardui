var _=Object.defineProperty;var x=s=>{throw TypeError(s)};var j=(s,t,e)=>t in s?_(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var d=(s,t,e)=>j(s,typeof t!="symbol"?t+"":t,e),y=(s,t,e)=>t.has(s)||x("Cannot "+e);var r=(s,t,e)=>(y(s,t,"read from private field"),e?e.call(s):t.get(s)),o=(s,t,e)=>t.has(s)?x("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e),l=(s,t,e,i)=>(y(s,t,"write to private field"),i?i.call(s,e):t.set(s,e),e);import{_ as $}from"./index-DSQQ7QIl.js";var c,m,f,n;class A{constructor(t,e=!1,i=typeof window<"u"){o(this,c);o(this,m);o(this,f);o(this,n,15*6e4);d(this,"host","");d(this,"headers",{});l(this,m,i),this.host=`http${e?"://localhost:8080":"s://api.bytez.com"}/models/v2/`,this.headers={lang:"javascript",Authorization:`Key ${t}`,"content-type":"application/json"},i===!1&&($(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]).then(h=>{var a;l(this,c,h.Readable??((a=h.default)==null?void 0:a.Readable))}),new Function('return import("undici")')().then(({Agent:h})=>{l(this,f,new h({keepAliveTimeout:r(this,n),keepAliveMaxTimeout:r(this,n),connectTimeout:r(this,n),headersTimeout:r(this,n),bodyTimeout:r(this,n)}))}))}async request(t,e,i,h){try{const a=await fetch(this.host+t,{method:e,headers:h===void 0?this.headers:{...this.headers,"provider-key":h},dispatcher:r(this,f),signal:AbortSignal.timeout(r(this,n)),body:i?JSON.stringify(i):void 0});if(e==="POST"&&!a.ok&&a.headers.get("content-type")!=="application/json"){const{error:g}=await a.json().catch(console.error);throw new Error(g||a.statusText)}return a.body!==null&&((i==null?void 0:i.stream)===!0||(i==null?void 0:i.json)===!1)?r(this,m)?a.body.pipeThrough(new TextDecoderStream):r(this,c).fromWeb(a.body,{encoding:"utf8"}):await a.json()}catch(a){return{error:a.message,output:null}}}}c=new WeakMap,m=new WeakMap,f=new WeakMap,n=new WeakMap;var w,v,p,T;class S{constructor(t,e,i,h){o(this,w);o(this,v);o(this,p,!1);o(this,T);d(this,"id");d(this,"params");d(this,"details");l(this,w,i),this.id=t,l(this,T,h),l(this,v,e.list.models({modelId:t}).then(a=>{var k;const g=["text-to-audio","text-to-image","text-to-video","text-to-speech"];this.details=((k=a==null?void 0:a.output)==null?void 0:k[0])??{},l(this,p,g.includes(this.details.task))}))}async run(t,e,i){const h={params:typeof e=="boolean"||e===void 0?void 0:e};return await r(this,v),(e===!0||i===!0)&&(r(this,p)?h.json=!1:h.stream=!0),h.input=t,r(this,w).request(this.id,"POST",h,r(this,T))}}w=new WeakMap,v=new WeakMap,p=new WeakMap,T=new WeakMap;var u;class P{constructor(t,e=!1,i){o(this,u);d(this,"list",{models:t=>r(this,u).request(`list/models${t!=null&&t.task?`?task=${t.task}`:""}${t!=null&&t.modelId?`?modelId=${t.modelId}`:""}`),tasks:()=>r(this,u).request("list/tasks")});d(this,"model",(t,e)=>new S(t,this,r(this,u),e));l(this,u,new A(t,e,i))}}u=new WeakMap;export{P as B};
