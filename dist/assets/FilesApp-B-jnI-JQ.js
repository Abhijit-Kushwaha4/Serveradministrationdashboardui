import{b as f,j as e,h as _,C as N,I as E,F as D,r as h,i as S}from"./index-DSQQ7QIl.js";import{l as A,a as g,d as b,w as H}from"./default_api-DTSHUdNI.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],P=f("chevron-down",L);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],I=f("file-archive",$);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],z=f("file-json",q);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],k=f("file",R);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],V=f("folder",T);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],W=f("wind",Z),B=t=>{var a;const l=(a=t.split(".").pop())==null?void 0:a.toLowerCase();if(l)switch(l){case"tsx":case"jsx":return e.jsx(N,{className:"w-4 h-4",color:"#61DAFB"});case"ts":case"js":return e.jsx(N,{className:"w-4 h-4",color:"#F7DF1E"});case"css":case"scss":case"mjs":return e.jsx(W,{className:"w-4 h-4",color:"#CC6699"});case"json":return e.jsx(z,{className:"w-4 h-4",color:"#F7DF1E"});case"md":return e.jsx(D,{className:"w-4 h-4",color:"#FFFFFF"});case"png":case"jpg":case"jpeg":case"gif":case"svg":return e.jsx(E,{className:"w-4 h-4",color:"#4CAF50"});case"zip":case"tar":case"gz":return e.jsx(I,{className:"w-4 h-4",color:"#FFC107"});case"html":return e.jsx(N,{className:"w-4 h-4",color:"#E34F26"});case"nix":return e.jsx(_,{className:"w-4 h-4",color:"#7E57C2"});default:return e.jsx(k,{className:"w-4 h-4",color:"#FFFFFF"})}return e.jsx(k,{className:"w-4 h-4",color:"#FFFFFF"})},J=t=>{const l={name:"Project Files",path:".",type:"folder",children:[]},a={".":l};return[...t].sort((c,i)=>c.localeCompare(i)).forEach(c=>{const i=c.split("/");let o="";for(let r=0;r<i.length;r++){const p=i[r],m=o;o=o?`${o}/${p}`:p;const x=r===i.length-1&&!c.endsWith("/");if(!a[o]){const u=a[m]||l,v={name:p,path:o,type:x?"file":"folder",children:x?void 0:[]};u.children&&(u.children.push(v),u.children.sort((y,j)=>y.type==="folder"&&j.type==="file"?-1:y.type==="file"&&j.type==="folder"?1:y.name.localeCompare(j.name))),a[o]=v}}}),l};function C({node:t,depth:l=0,onFileSelect:a,onContextMenu:d}){const[c,i]=h.useState(l<2),o=()=>{t.type==="folder"&&i(!c)};return e.jsxs("div",{children:[e.jsxs("div",{onClick:o,onContextMenu:r=>d(r,t),className:"flex items-center gap-2 px-3 py-1.5 hover:bg-opacity-10 hover:bg-white cursor-pointer rounded transition-colors duration-150",style:{paddingLeft:`${l*24+12}px`},children:[t.type==="folder"?e.jsx(e.Fragment,{children:c?e.jsx(P,{className:"w-4 h-4 text-gray-500"}):e.jsx(S,{className:"w-4 h-4 text-gray-500"})}):e.jsx("div",{className:"w-4"}),e.jsx("div",{onClick:r=>{t.type==="file"&&(r.stopPropagation(),a(t))},children:t.type==="folder"?e.jsx(V,{className:"w-4 h-4 text-cyber-amber"}):B(t.name)}),e.jsx("span",{className:"text-sm font-mono text-gray-300 select-none",onClick:r=>{t.type==="file"&&(r.stopPropagation(),a(t))},children:t.name})]}),c&&t.children&&e.jsx("div",{children:t.children.map(r=>e.jsx(C,{node:r,depth:l+1,onFileSelect:a,onContextMenu:d},r.path))})]})}const O=({menu:t,onRename:l,onDelete:a,onClose:d})=>t.visible?e.jsx("div",{className:"absolute z-50 w-40 bg-cyber-dark-surface border border-cyber-border rounded-md shadow-lg",style:{top:t.y,left:t.x},onClick:d,children:e.jsxs("ul",{className:"py-1",children:[e.jsx("li",{className:"px-3 py-1.5 text-sm text-gray-300 hover:bg-cyber-primary cursor-pointer",onClick:()=>l(t.node),children:"Rename"}),e.jsx("li",{className:"px-3 py-1.5 text-sm text-red-500 hover:bg-cyber-primary cursor-pointer",onClick:()=>a(t.node),children:"Delete"})]})}):null;function G(){const[t,l]=h.useState(null),[a,d]=h.useState(null),[c,i]=h.useState(!0),[o,r]=h.useState(null),[p,m]=h.useState({visible:!1,x:0,y:0,node:null}),x=h.useCallback(async()=>{i(!0);try{const{result:s}=await A("."),n=J(s);l(n)}catch(s){r("Failed to load file structure."),console.error(s)}finally{i(!1)}},[]);h.useEffect(()=>{x();const s=()=>m({...p,visible:!1});return window.addEventListener("click",s),()=>{window.removeEventListener("click",s)}},[x]);const u=async s=>{if(s.type==="file")try{const{result:n}=await g(s.path);d({path:s.path,content:n})}catch(n){console.error("Failed to read file:",n),d({path:s.path,content:"Error reading file content."})}},v=(s,n)=>{s.preventDefault(),s.stopPropagation(),m({visible:!0,x:s.clientX,y:s.clientY,node:n})},y=async s=>{const n=prompt("Enter new name for"+s.name);if(n&&n!==s.name){const w=s.path,M=w.substring(0,w.lastIndexOf("/")+1)+n;try{const{result:F}=await g(w);await H(M,F),await b(w),x()}catch(F){console.error("Rename failed:",F),alert("Failed to rename the file.")}}},j=async s=>{if(confirm("Are you sure you want to delete"+s.name+"?"))try{await b(s.path),(a==null?void 0:a.path)===s.path&&d(null),x()}catch(n){console.error("Delete failed:",n),alert("Failed to delete the file.")}};return c?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-gray-400",children:"Loading Files..."})}):o?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-red-500",children:o})}):e.jsxs("div",{className:"flex h-full bg-cyber-obsidian text-white font-sans",children:[e.jsx("div",{className:"w-1/3 max-w-xs border-r border-cyber-border overflow-y-auto py-4",children:t&&e.jsx(C,{node:t,onFileSelect:u,onContextMenu:v})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-cyber-border",children:e.jsx("h2",{className:"text-lg font-bold text-gray-200",children:a?a.path:"Select a file to view"})}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:a?e.jsx("pre",{className:"text-sm text-gray-300 whitespace-pre-wrap font-mono",children:a.content}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-gray-500",children:"No file selected"})})})]}),e.jsx(O,{menu:p,onRename:y,onDelete:j,onClose:()=>m({...p,visible:!1})})]})}export{G as FilesApp};
